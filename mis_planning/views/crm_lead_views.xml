<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="mis_crm_lead_form_view" model="ir.ui.view">
        <field name="name">mis.crm.lead.form</field>
        <field name="model">crm.lead</field>
         <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">

            <!--xpath expr="//div[hasclass('oe_button_box')]" position="inside"-->

             <field name="stage_id" position="replace">
             <field name="stage_id" widget="statusbar"
                            options="{'fold_field': 'fold'}"
                            domain="['|', ('team_id', '=', team_id), ('team_id', '=', False)]"
                            attrs="{'invisible': ['|', ('active', '=', False), ('type', '=', 'lead')]}"/>

            </field>



            <xpath expr="//button[@name='action_set_won_rainbowman']" position="replace">
                <field name="planning_id" invisible="1"/>
                <field name="is_won" invisible="1"/>
                <field name="is_planning" invisible="1"/>
                 <field name="is_closed" invisible="1"/>
                <field name="is_approve_status" invisible="1"/>
                <field name="is_transfer" invisible="1"/>

                <button name="button_approve" type="object"  string="Approve" class="oe_highlight" attrs="{'invisible': ['|', '|', ('stage_id','not in', (4,5)), ('uid', '!=',2), ('is_approve_status', '!=',1)]}"  groups="account.group_account_manager"/>

                <button name="action_send_email"  string="Approval Request"  class="oe_highlight" type="object" attrs="{'invisible': ['|', '|', ('stage_id', 'not in', (4,5)), ('uid', '=',2), ('is_approve_status', '=',1)]}"/>
                <button name="popup_planning"  string="Check Planning"  class="oe_highlight" type="object"/>

                <button name="action_set_won_rainbowman" string="Mark Won"
                            type="object" class="oe_highlight"
                            attrs="{'invisible': ['|', ('is_closed', '!=', False), ('is_won', '!=', False), ('is_planning','!=', False)]}"/>
                <button class="oe_highlight" name="action_transfer2planning" type="object" string="Transferred to Planning" style="width: 200px;" attrs="{'invisible': [('is_won', '!=', True)]}"/>
            </xpath>
             <xpath expr="//button[@name='action_set_lost']" position="replace">
                <button name="action_set_lost" string="Mark as Lost" type="object" attrs="{'invisible': ['|', ('type', '=', 'opportunity'), '&amp;', ('probability', '=', 0), ('active', '=', False), ('is_won', '=', True)]}"/>
            </xpath>
             <field name="phone" position="after">

                 <field name="job_startdate" attrs="{'invisible': [('stage_id', 'not in', (4,5))], 'required':[('is_won', '=', True), ('is_transfer', '=', True)], 'readonly':[('is_transfer', '=', True), ('uid', '!=', 2)]}"/>
                 <field name="job_enddate" attrs="{'invisible': [('stage_id', 'not in', (4,5))], 'required':[('is_won', '=', True), ('is_transfer', '=', True)], 'readonly':[('is_transfer', '=', True), ('uid', '!=', 2)]}"/>
                 <field name="job_totalhours" attrs="{'invisible': [('stage_id', 'not in', (4,5))]}"/>
             </field>
            <field name="date_deadline" position="replace"/>
             <field name="partner_id" position="replace">
                 <field name="partner_id" required="1"/>
             </field>
            <field name="tag_ids" position="after">
                <field name="planning_id" attrs="{'invisible': [('planning_id', '=', False)]}"/>
                <field name="job_team_id" attrs="{'required':[('is_won', '=', True), ('is_transfer', '=', True)], 'invisible': [('stage_id', 'in', (1,2,3))]}"/>
                <field name="area_id" attrs="{'required':[('is_won', '=', True), ('is_transfer', '=', True)]}"/>
                <field name="unit_number"/>
                <field name="building_name"/>
                <field name="scope"/>
            </field>
            <field name="user_id" position="before">
                <field name="source_id" required="1"/>
            </field>
             <!--field name="user_id" position="before">
                 <button name="previous_stage"  string="Previous"  class="oe_highlight" type="object"/>
                 <button name="next_stage"  string="Next"  class="oe_highlight" type="object"/>
                 <br/>

             </field-->
        </field>
    </record>

    <record id="mis_crm_stage_form_view" model="ir.ui.view">
        <field name="name">mis.crm.stage.form</field>
        <field name="model">crm.stage</field>
         <field name="inherit_id" ref="crm.crm_stage_form"/>
        <field name="arch" type="xml">
            <field name="fold" position="after">
                <field name="is_planning"/>
                <field name="is_closed"/>
                <field name="is_approval_reqired"/>
             </field>
        </field>
    </record>

    <record id="mis_crm_stage_tree_view" model="ir.ui.view">
        <field name="name">mis.crm.stage.treee</field>
        <field name="model">crm.stage</field>
         <field name="inherit_id" ref="crm.crm_stage_tree"/>
        <field name="arch" type="xml">
            <field name="is_won" position="after">
                <field name="is_planning"/>
                <field name="is_closed"/>
                <field name="is_approval_reqired"/>
             </field>
        </field>
    </record>

</odoo>